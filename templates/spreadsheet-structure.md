# 📊 スプレッドシート構造ガイド

Google Spreadsheetで以下のシート構成を作成してください。

---

## 🐱 シート1: 「日次記録」

| 列 | 項目名 | 形式 | 説明 |
|----|--------|------|------|
| A | 日付 | YYYY/MM/DD | 記録日 |
| B | 猫 | テキスト | ラッキー / ミー |
| C | 体重(kg) | 数値 | 例: 4.2 |
| D | 元気度 | テキスト | 元気 / 普通 / 低下 |
| E | 食欲 | テキスト | 増 / 普通 / 減 / なし |
| F | 飲水量(cc) | 数値 | 例: 200 |
| G | カリカリ(g) | 数値 | 例: 30 |
| H | ウェット(g) | 数値 | 例: 20 |
| I | チュール(本) | 数値 | 例: 1.5 |
| J | おやつ(袋) | 数値 | 例: 2 |
| K | 尿回数 | 数値 | 例: 10 |
| L | 便回数 | 数値 | 例: 2 |
| M | 便の状態 | テキスト | 良好 / 硬い / 柔らかい / なし |
| N | 点滴 | 数値 | 点滴した場合のcc（空欄可） |
| O | メモ | テキスト | その日の気になった点 |

---

## 🚽 シート2: 「排泄詳細」

| 列 | 項目名 | 形式 | 説明 |
|----|--------|------|------|
| A | 日付 | YYYY/MM/DD | 記録日 |
| B | 時刻 | HH:MM | 例: 09:30 |
| C | 猫 | テキスト | ラッキー / ミー |
| D | 種類 | テキスト | 尿 / 便 / 両方 |
| E | 量 | テキスト | 普通 / 多め / 少量 / 数滴 |
| F | メモ | テキスト | 血尿、色など |

---

## 💊 シート3: 「投薬記録」

| 列 | 項目名 | 形式 | 説明 |
|----|--------|------|------|
| A | 日付 | YYYY/MM/DD | 記録日 |
| B | 猫 | テキスト | ラッキー / ミー |
| C | タイミング | テキスト | 朝 / 昼 / 夜 |
| D | 投薬リスト | テキスト | カンマ区切り（例: rapros,lactulose） |
| E | メモ | テキスト | 追加の薬・メモ |
| F | 更新日時 | 日時 | 自動設定 |

💡 投薬リストには薬マスターシートのkeyをカンマ区切りで保存します。

---

## 🏥 シート4: 「診察記録」

| 列 | 項目名 | 形式 | 説明 |
|----|--------|------|------|
| A | 日時 | YYYY/MM/DD HH:MM | 診察日時 |
| B | 猫 | テキスト | ラッキー / ミー |
| C | 体重(kg) | 数値 | 診察時の体重 |
| D | 点滴 | TRUE/FALSE | チェックボックス |
| E | 点滴量(cc) | 数値 | 例: 200 |
| F | エコー検査 | TRUE/FALSE | チェックボックス |
| G | 血液検査 | TRUE/FALSE | チェックボックス |
| H | 尿検査 | TRUE/FALSE | チェックボックス |
| I | 所見・診断 | テキスト | 先生のお話 |
| J | 処方薬 | テキスト | 処方された薬 |

---

## 💊 シート5: 「薬マスター」（NEW!）

薬の種類を簡単に追加・編集できるマスターシートです。

| 列 | 項目名 | 形式 | 説明 |
|----|--------|------|------|
| A | key | テキスト | 英語キー（例: rapros） |
| B | 名前 | テキスト | 表示名（例: ラプロス） |
| C | 種類 | テキスト | 処方薬 / サプリ |
| D | 色 | テキスト | HEXカラー（例: #E8927C） |

### サンプルデータ

| key | 名前 | 種類 | 色 |
|-----|------|------|-----|
| rapros | ラプロス | 処方薬 | #E8927C |
| lactulose | ラクツロース | 処方薬 | #7CBAAB |
| clavaseptin | クラバセプチン | 処方薬 | #56CCF2 |
| vibramycin | ビブラマイシン | 処方薬 | #F2C94C |
| veraflox | ベラフロックス | 処方薬 | #27AE60 |
| appetite | ミルタザビン（食欲増進薬） | 処方薬 | #EB5757 |
| cranberry | クランベリBB | サプリ | #BB6BD9 |
| azodyl | アゾディル | サプリ | #F2994A |
| renalzin | レンジアレン | サプリ | #6FCF97 |

💡 **ヒント**: 新しい薬を追加するには、このシートに行を追加するだけでOK！アプリに自動で反映されます。

---

## 📈 推奨するLooker Studioダッシュボード構成

### ページ1: 概要
- 期間選択フィルター
- 猫選択フィルター
- 体重の推移（折れ線グラフ）
- 食事量の推移（積み上げ棒グラフ）
- 飲水量の推移（折れ線グラフ）

### ページ2: 排泄分析
- 1日あたりの排尿回数（棒グラフ）
- 排泄時刻の分布（ヒートマップ）
- 投薬と排泄回数の相関

### ページ3: 診察履歴
- 診察一覧（テーブル）
- 体重変化と診察日のマーカー
- 処方薬の履歴

---

## 🔗 Google Apps Scriptとの連携

`gas/Code.gs` ファイルをGoogle Apps Scriptに貼り付けると、
アプリからスプレッドシートに直接データを保存できます。

### セットアップ手順
1. Google Spreadsheetを作成
2. 拡張機能 → Apps Script を開く
3. `gas/Code.gs` のコードを貼り付け
4. スプレッドシートIDを設定
5. ウェブアプリとしてデプロイ
6. アプリの設定でURL を入力

